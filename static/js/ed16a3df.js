import{_ as e,c as a,u as l,R as r,e as s}from"./35bc27a3.js";import{s as t}from"./ee7ce8fe.js";import{r as i,a4 as o}from"./9b9cf7db.js";import{r as u,w as d,G as n,q as c,x as v,L as p,I as m,y as f,O as g,J as b,K as y,N as _}from"./5bdea638.js";import"./2b425f2d.js";import"./1e98e625.js";import"./c229d341.js";import"./9737f36b.js";const h={key:0,class:"kilo-error-input"},j={class:"list-ul"},z=e({__name:"CreateCode",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","callback"],setup(e,{emit:z}){const{t:k}=a(),C=l();t(C);const{operateReferral:$,getContractAddress:w}=s(),x=u(!1),I=/^[a-z0-9]{1,20}$/,N=u(""),V=u(!1),A=u(""),O=async()=>{if(V.value)return;if(!N.value)return void(V.value=!0);x.value=!0;const{referralStorageManagerAddr:e,chainId:a}=w();if("0x0000000000000000000000000000000000000000"==await i({address:e,abi:r.abi,functionName:"codeOwners",chainId:a,args:[o(N.value,{size:32})]})){const e=await $([o(N.value,{size:32})],"registerCode",k("referral.createCode"));x.value=!1,e&&(z("callback"),R())}else A.value="referral.registered";x.value=!1},R=()=>{A.value="",V.value=!1,N.value="",z("update:visible",!1)};return d((()=>N.value),(()=>{!I.test(N.value)&&N.value?V.value=!0:V.value=!1})),(e,a)=>{const l=n("a-input"),r=n("a-space"),s=n("a-typography-paragraph"),t=n("a-button");return c(),v("div",null,[p(r,{direction:"vertical",size:[0,17],fill:""},{default:m((()=>[f("div",null,[p(l,{class:"kilo-input-order",modelValue:N.value,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),placeholder:e.$t("referral.codeNamePlaceholder"),"max-length":20,size:"large",onFocus:a[1]||(a[1]=e=>A.value=""),error:!!A.value},null,8,["modelValue","placeholder","error"]),A.value?(c(),v("div",h,g(e.$t(A.value)),1)):b("",!0)]),f("div",null,[p(s,{style:{"margin-bottom":"0"}},{default:m((()=>[f("ul",j,[p(r,{direction:"vertical",size:[0,10],fill:""},{default:m((()=>[f("li",{class:y(V.value&&"error")},g(e.$t("referral.createTips1")),3),f("li",null,g(e.$t("referral.createTips2")),1)])),_:1})])])),_:1})]),p(t,{type:"primary",size:"large",long:"",onClick:O,loading:x.value,disabled:x.value},{default:m((()=>[_(g(e.$t("public.confirm")),1)])),_:1},8,["loading","disabled"])])),_:1})])}}},[["__scopeId","data-v-435005a0"]]);export{z as default};
