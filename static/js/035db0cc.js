import{_ as e,u as a,c as l,s as i,o as t}from"./35bc27a3.js";import{s as o}from"./ee7ce8fe.js";import{B as s}from"./1e98e625.js";import{j as r,r as u,G as n,q as v,H as d,I as c,N as m,O as p,y as g,L as f,u as b,x as _,J as k}from"./5bdea638.js";import"./2b425f2d.js";import"./9b9cf7db.js";import"./c229d341.js";import"./9737f36b.js";const w={class:"kilo-input-label"},j={key:0,class:"kilo-error-input"},x={class:"kilo-addmargin-item"},y={class:"label"},M={class:"value"},$={class:"kilo-addmargin-item"},z={class:"label"},I={class:"value"},C=e({__name:"KiloAddMargin",props:{visible:{type:Boolean,default:!1},record:{type:Object,default:()=>({})}},emits:["update:visible","callback"],setup(e,{emit:C}){const L=e,V=a(),{t:h}=l(),{activeProduct:q,currentQuote:B,walletInfo:F,minMargin:N}=o(V),O=r((()=>{var e;return null==(e=q.value)?void 0:e.minLeverage})),A=u(""),D=r((()=>{var e,a;if(L.visible){const l=new s(L.record.margin).times(L.record.leverage).div(O.value).minus(L.record.margin);return new s(null==(e=F.value)?void 0:e.balance).gte(l)?l:new s(null==(a=F.value)?void 0:a.balance)}return 0})),G=u(""),H=u(""),J=e=>{var a;const l=t(e,null==(a=q.value)?void 0:a.quoteDecimal);l>Number(D.value.toString())?A.value=D.value.toFixed(2,1):A.value=l,(()=>{if(A.value){const e=new s(L.record.margin).plus(A.value);G.value=new s(L.record.margin).times(L.record.leverage).div(e).toFixed(2,1)}else G.value="";!new s(O.value).gt(G.value)&&new s(A.value).gte(N.value)&&(H.value="")})()},K=()=>{new s(O.value).gt(G.value)?H.value=h("error.addMargin",{a:O.value+"x"}):new s(A.value).lt(N.value)?H.value=h("error.minMargin",{a:N.value,b:B.value}):A.value&&(C("callback",A.value),P())},P=()=>{H.value="",A.value="",G.value="",C("update:visible",!1)};return(a,l)=>{const t=n("a-input"),o=n("a-space"),s=n("a-button"),r=n("a-col"),u=n("a-row"),C=n("a-modal");return v(),d(C,{visible:e.visible,onCancel:P,"modal-class":"kilo-leverage-modal","render-to-body":!0,footer:!1,width:"343px","title-align":"start","unmount-on-close":""},{title:c((()=>[m(p(a.$t("positions.addMargin")),1)])),default:c((()=>[g("div",null,[f(o,{direction:"vertical",size:[0,24],fill:""},{default:c((()=>[g("div",null,[g("div",w,p(a.$t("positions.amount")),1),f(t,{onInput:l[0]||(l[0]=e=>J(A.value)),class:"kilo-input-order",modelValue:A.value,"onUpdate:modelValue":l[1]||(l[1]=e=>A.value=e),placeholder:"0",size:"large"},{suffix:c((()=>[m(p(b(B)),1)])),_:1},8,["modelValue"]),H.value?(v(),_("div",j,p(H.value),1)):k("",!0)]),f(o,{direction:"vertical",size:[0,8],fill:""},{default:c((()=>[g("div",x,[g("div",y,p(a.$t("positions.upToIncrease")),1),g("div",M,p(b(i)(b(D)||0))+" "+p(b(B)),1)]),g("div",$,[g("div",z,p(a.$t("positions.afterMarginLeverage")),1),g("div",I,p(G.value||"--")+"x",1)])])),_:1}),f(u,{gutter:16},{default:c((()=>[f(r,{span:12},{default:c((()=>[f(s,{size:"large",long:"",onClick:P},{default:c((()=>[m(p(a.$t("public.cancel")),1)])),_:1})])),_:1}),f(r,{span:12},{default:c((()=>[f(s,{type:"primary",size:"large",long:"",onClick:K,class:"kiloex-position kiloex-position-deposit-confirm"},{default:c((()=>[m(p(a.$t("public.confirm")),1)])),_:1})])),_:1})])),_:1})])),_:1})])])),_:1},8,["visible"])}}},[["__scopeId","data-v-8b71be95"]]);export{C as default};
