import{_ as e,c as a,u as l,R as r,e as s}from"./35bc27a3.js";import{s as t}from"./ee7ce8fe.js";import{r as i,a4 as o}from"./9b9cf7db.js";import{r as u,w as d,G as n,q as c,H as v,I as p,N as m,O as f,y as b,L as g,x as y,J as _,K as h}from"./5bdea638.js";import"./2b425f2d.js";import"./1e98e625.js";import"./c229d341.js";import"./9737f36b.js";const j={class:"kilo-input-label"},k={key:0,class:"kilo-error-input"},C={class:"list-ul"},$=e({__name:"CreateCodeModel",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","callback"],setup(e,{emit:$}){const{t:z}=a(),w=l();t(w);const{operateReferral:x,getContractAddress:I}=s(),N=u(!1),V=/^[a-z0-9]{1,20}$/,A=u(""),M=u(!1),O=u(""),R=async()=>{if(M.value)return;if(!A.value)return void(M.value=!0);N.value=!0;const{referralStorageManagerAddr:e,chainId:a}=I();if("0x0000000000000000000000000000000000000000"==await i({address:e,abi:r.abi,functionName:"codeOwners",chainId:a,args:[o(A.value,{size:32})]})){const e=await x([o(A.value,{size:32})],"registerCode",z("referral.createCode"));N.value=!1,e&&($("callback"),T())}else O.value="referral.registered";N.value=!1},T=()=>{O.value="",M.value=!1,A.value="",$("update:visible",!1)};return d((()=>A.value),(()=>{!V.test(A.value)&&A.value?M.value=!0:M.value=!1})),(a,l)=>{const r=n("a-input"),s=n("a-space"),t=n("a-typography-paragraph"),i=n("a-button"),o=n("a-modal");return c(),v(o,{visible:e.visible,onCancel:T,"modal-class":"kilo-bindcode-modal","render-to-body":!0,footer:!1,width:"343px","title-align":"start","unmount-on-close":""},{title:p((()=>[m(f(a.$t("referral.createCode")),1)])),default:p((()=>[b("div",null,[g(s,{direction:"vertical",size:[0,17],fill:""},{default:p((()=>[b("div",null,[b("div",j,f(a.$t("referral.codeName")),1),g(r,{class:"kilo-input-order",modelValue:A.value,"onUpdate:modelValue":l[0]||(l[0]=e=>A.value=e),placeholder:a.$t("referral.codeNamePlaceholder"),"max-length":20,size:"large",onFocus:l[1]||(l[1]=e=>O.value=""),error:!!O.value},null,8,["modelValue","placeholder","error"]),O.value?(c(),y("div",k,f(a.$t(O.value)),1)):_("",!0)]),b("div",null,[g(t,{style:{"margin-bottom":"0"}},{default:p((()=>[b("ul",C,[g(s,{direction:"vertical",size:[0,10],fill:""},{default:p((()=>[b("li",{class:h(M.value&&"error")},f(a.$t("referral.createTips1")),3),b("li",null,f(a.$t("referral.createTips2")),1)])),_:1})])])),_:1})]),g(i,{type:"primary",size:"large",long:"",onClick:R,loading:N.value,disabled:N.value},{default:p((()=>[m(f(a.$t("public.confirm")),1)])),_:1},8,["loading","disabled"])])),_:1})])])),_:1},8,["visible"])}}},[["__scopeId","data-v-8b45997d"]]);export{$ as default};
