import{_ as a,m as e,u as l,T as s,s as t,g as i,o,U as u,C as v,x as n,e as c}from"./35bc27a3.js";import{s as d}from"./ee7ce8fe.js";import{B as r}from"./1e98e625.js";import{r as p}from"./9b9cf7db.js";import{r as m,w as b,G as f,q as g,H as k,I as y,N as T,O as $,y as _,L as w,u as x,x as j,ab as I,ac as z}from"./5bdea638.js";import"./2b425f2d.js";import"./c229d341.js";import"./9737f36b.js";const C=a=>(I("data-v-c03b1b8d"),a=a(),z(),a),S={class:"deposit-content"},U={class:"tips"},h={class:"title"},A={class:"list-item"},D=C((()=>_("span",{class:"dot"},null,-1))),R={class:"context"},V={class:"list-item"},B=C((()=>_("span",{class:"dot"},null,-1))),F={class:"context"},K={class:"list-item"},N=C((()=>_("span",{class:"dot"},null,-1))),q={class:"context"},G={class:"list-item"},H=C((()=>_("span",{class:"dot"},null,-1))),L={class:"context"},M={class:"deposit"},O={class:"title"},P={class:"input-label"},Q={class:"left"},X={class:"suffix"},E=["src"],J={class:"receive"},W={class:"label"},Y={class:"value"},Z={key:1},aa=["src"],ea={class:"price-rate"},la={class:"footer"},sa=a({__name:"Deposit",props:{visible:{type:Boolean,default:!1},priceRate:{type:String,default:""},callback:{type:Function,default:()=>{}}},emits:["update:visible"],setup(a,{emit:I}){const z=a,C=m(""),{addToken:sa}=e(),ta=l(),ia=s(),{currentQuote:oa,walletInfo:ua,chainId:va}=d(ta),{symbol:na,decimal:ca}=d(ia),{getContractAddress:da,openPositionAction:ra}=c(),pa=m(!1),ma=m(""),ba=m(),fa=m(!1),ga=m(!1),ka=m(),ya=m("");b((()=>z.visible),(a=>{a&&(ya.value=z.priceRate)}));const Ta=a=>{const e=o(a,2)||"";new r(e||0).lt(ua.value.balance)?ma.value=e||"":ma.value=t(ua.value.balance)||"",clearTimeout(ka.value),ka.value=setTimeout((()=>{ba.value="",fa.value=!0,$a()}),500)},$a=async()=>{if(ma.value){const{vaultStakeRewardAddr:a}=da(),e=await p({address:a,abi:u.abi,chainId:va.value,functionName:"previewDeposit",args:[v(ma.value||0,ca.value)]});ba.value=n(e,ca.value),fa.value=!1}else ba.value="",fa.value=!1},_a=async()=>{const{vaultStakeRewardAddr:a}=da();await sa(va.value,{address:a,symbol:na.value,decimals:ca.value,logoURI:"../../../assets/img/token/KUSD.svg"})},wa=a=>{C.value=(null==a?void 0:a.key)||""},xa=async()=>{if(!ma.value||0==ma.value)return void(pa.value=!0);pa.value=!1,ga.value=!0;const a=await ra([v(ma.value),ua.value.account],"deposit",4,"","","","",wa);ga.value=!1,a&&(ma.value="",ba.value="",z.callback(),ja())},ja=()=>{ma.value="",ba.value="",clearTimeout(ka.value),I("update:visible",!1)};return(e,l)=>{const s=f("a-input"),o=f("a-spin"),u=f("icon-plus"),v=f("a-button"),n=f("a-space"),c=f("a-modal");return g(),k(c,{visible:a.visible,onCancel:ja,"modal-class":"kilo-vault-modal","render-to-body":!0,footer:!1,width:"650px","title-align":"start","unmount-on-close":""},{title:y((()=>[T($(e.$t("vault.deposit")),1)])),default:y((()=>[_("div",S,[w(n,{size:[0,0],align:"start",fill:"",class:"deposit-content-space"},{default:y((()=>{var a;return[_("div",U,[_("div",h,$(e.$t("vault.tips")),1),_("div",A,[D,_("div",R,$(e.$t("vault.depositTips1",{token:x(oa)})),1)]),_("div",V,[B,_("div",F,$(e.$t("vault.depositTips2")),1)]),_("div",K,[N,_("div",q,$(e.$t("vault.depositTips3")),1)]),_("div",G,[H,_("div",L,$(e.$t("vault.depositTips4")),1)])]),_("div",M,[_("div",null,[_("div",O,$(e.$t("vault.deposit")),1),_("div",P,[_("div",Q,$(e.$t("public.balance"))+": "+$(x(t)((null==(a=x(ua))?void 0:a.balance)||0))+" "+$(x(oa)),1),_("div",{class:"right",onClick:l[0]||(l[0]=a=>{var e;return Ta((null==(e=x(ua))?void 0:e.balance)||0)})}," MAX ")]),w(s,{class:"kilo-input-order",modelValue:ma.value,"onUpdate:modelValue":l[1]||(l[1]=a=>ma.value=a),placeholder:"0",size:"large",onFocus:l[2]||(l[2]=a=>pa.value=!1),error:pa.value,onInput:l[3]||(l[3]=a=>Ta(ma.value))},{suffix:y((()=>[_("span",X,[T($(x(oa))+" ",1),_("img",{class:"token-img",src:x(i)("token/USDT.svg"),alt:"",srcset:""},null,8,E)])])),_:1},8,["modelValue","error"]),_("div",J,[_("span",W,$(e.$t("vault.receive")),1),_("span",Y,[fa.value?(g(),k(o,{key:0,size:12})):(g(),j("span",Z,$(ba.value?x(t)(ba.value):"--"),1)),T(" "+$(x(na)),1)]),_("img",{class:"token-img",src:x(i)("token/KUSD.svg"),alt:"",srcset:""},null,8,aa)]),_("div",ea," (1 "+$(x(oa))+" = "+$(x(t)(ya.value,2)||"--")+" "+$(x(na))+") ",1)]),_("div",la,[w(n,{size:[8,12],fill:"",direction:"vertical"},{default:y((()=>[w(v,{size:"large",type:"outline",long:"",onClick:_a},{icon:y((()=>[w(u)])),default:y((()=>[T(" "+$(e.$t("vault.addToken",{token:x(na)})),1)])),_:1}),w(v,{type:"primary",size:"large",long:"",onClick:xa,loading:ga.value,disabled:ga.value},{default:y((()=>[T($(e.$t(C.value||"vault.submit")),1)])),_:1},8,["loading","disabled"])])),_:1})])])]})),_:1})])])),_:1},8,["visible"])}}},[["__scopeId","data-v-c03b1b8d"]]);export{sa as default};
