import{_ as e,c as i,u as o,s,q as t,t as l,v as r,e as a}from"./35bc27a3.js";import{s as n}from"./ee7ce8fe.js";import{B as d}from"./1e98e625.js";import{r as c,j as u,G as p,q as g,H as v,I as m,N as b,O as y,L as f,y as k,u as L,x as h,F as j,a1 as x,K as P,J as $,ab as _,ac as T}from"./5bdea638.js";import"./2b425f2d.js";import"./9b9cf7db.js";import"./c229d341.js";import"./9737f36b.js";const w={class:"kilo-order-list"},A={class:"kilo-order-list-item"},D={class:"title"},I=(e=>(_("data-v-b4e7fcb6"),e=e(),T(),e))((()=>k("span",null," | ",-1))),z=["innerHTML"],C={class:"operate"},O={key:1},F=e({__name:"KiloMarketClose",props:{visible:{type:Boolean,default:!1},record:{type:Object,default:()=>({})}},emits:["update:visible","callback"],setup(e,{emit:_}){const T=e,{t:F}=i(),{openPositionAction:q}=a(),H=e=>e.isLong&&e.triggerAboveThreshold?">=":e.isLong&&!e.triggerAboveThreshold?"<=":e.isLong||e.triggerAboveThreshold?!e.isLong&&e.triggerAboveThreshold?">=":void 0:"<=",M=o(),{currentQuote:B,openOrderList:K,cumulativeFundings:G}=n(M),J=c([]),N=e=>new d(e.size).div(new d(T.record.size)).times(100).toFixed(2,1),Q=e=>{var i;if(!T.visible)return{};return{...l({isLong:e.isLong,funding:T.record.funding,leverage:T.record.leverage,margin:new d(e.size).div(T.record.leverage),price:T.record.price,marketPrice:e.triggerPrice,cumulativeFunding:(null==(i=G.value)?void 0:i[e.productId])||"0"})}},S=u((()=>K.value.filter((e=>{var i,o;return e.productId==(null==(i=T.record)?void 0:i.productId)&&"stop"==e.type&&e.isLong==(null==(o=T.record)?void 0:o.isLong)&&-1==J.value.indexOf(e.index)})))),E=()=>{_("callback"),_("update:visible",!1)};return(i,o)=>{const l=p("icon-loading"),a=p("a-button"),n=p("a-empty"),d=p("a-modal");return g(),v(d,{visible:e.visible,onCancel:o[0]||(o[0]=e=>_("update:visible",!1)),"modal-class":"kilo-market-close-modal","body-class":"kilo-market-close-modal-body","render-to-body":!0,width:"600px","title-align":"start","unmount-on-close":""},{title:m((()=>[b(y(i.$t("closePosition.title")),1)])),footer:m((()=>[f(a,{type:"primary",size:"medium",onClick:E},{default:m((()=>[b(y(i.$t("closePosition.skip")),1)])),_:1})])),default:m((()=>[k("div",w,[L(S).length?(g(!0),h(j,{key:0},x(L(S),((e,o)=>{var n,d;return g(),h("div",A,[k("div",D,y(i.$t("closePosition.order"))+" "+y(o+1),1),k("div",null,[k("span",{class:P(e.isLong?"down":"up")},y(e.symbol)+" ("+y(e.isLong?i.$t("order.sell"):i.$t("order.buy"))+") ",3),I,k("span",{class:"content",innerHTML:i.$t("closePosition."+((e.isLong?">="==H(e):"<="==H(e))?"content":"contentStop"),{a:[H(e),e.triggerPrice," ",L(B)].join(""),b:N(e)+"%",c:L(s)((null==(n=Q(e))?void 0:n.pnl)||0,L(t)(e.productId,"quoteDecimal"))+L(B),class:null==(d=Q(e))?void 0:d.type})},null,8,z)]),k("div",C,[f(a,{type:"outline",size:"medium",onClick:i=>(async e=>{e.loadingDelete=!0;const i=await q([e.index],"cancelDecreaseOrder",2,e.symbol,e.isLong,F(`${r(e.isLong,e.triggerAboveThreshold).text}`));e.loadingDelete=!1,i&&J.value.push(e.index)})(e),disabled:!!e.loadingDelete},{default:m((()=>[e.loadingDelete?(g(),v(l,{key:0})):$("",!0),b(" "+y(i.$t("public.cancel")),1)])),_:2},1032,["onClick","disabled"])])])})),256)):(g(),h("div",O,[f(n)]))])])),_:1},8,["visible"])}}},[["__scopeId","data-v-b4e7fcb6"]]);export{F as default};
